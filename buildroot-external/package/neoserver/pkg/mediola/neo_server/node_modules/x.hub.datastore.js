var x=x||{};x.hub=x.hub||{};x.hub.datastore=x.hub.datastore||{};
x.hub.datastore.DataStore=function(){var a=function(b){this._file=b};a.DB_FILE="xhub.db";a.prototype.init=function(b,c){var d=require("fs-extra"),a=require("path");this._file||(this._file=a.resolve(b.getUserRootDataPath(),"xhub.db"));var e=this;d.ensureFile(this._file,function(b){b?c&&c(b):e._initDB(c)})};a.prototype._initDB=function(b){var c=new (require("sqlite3").Database)(this._file,function(a){a?b&&b(a):c.serialize(function(){c.run("CREATE TABLE IF NOT EXISTS windowstate (id integer primary key autoincrement, window text, state text, time datetime default current_timestamp)",function(a){c.close();
b&&b(a)})})})};a.prototype.openDB=function(b){var a=new (require("sqlite3").Database)(this._file,function(d){b&&b(d,a)})};a.prototype._dumpTable=function(b){this.openDB(function(a,d){!a&&d&&d.each("SELECT * FROM "+b,function(b,a){XC.debugf(a);d.close()})})};return a}();x.hub.datastore.Handler=function(){this.dataStore=new x.hub.datastore.DataStore};x.hub.datastore.Handler.prototype.DataStore=x.hub.datastore.DataStore;
x.hub.datastore.Handler.prototype.init=function(a,b){this.dataStore.init(a,function(a){b&&b({error:a})})};module.exports=new x.hub.datastore.Handler;
