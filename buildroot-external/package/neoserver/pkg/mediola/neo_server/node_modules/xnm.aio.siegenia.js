function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}var xnm=xnm||{};xnm.aio=xnm.aio||{},xnm.aio.siegenia=xnm.aio.siegenia||{},xnm.aio.siegenia._Session=function(){var e=function e(_e){this._logger=require("x.logger.js").getLogger("xnm.aio.siegenia._Session"),this.ip=_e.ip,this.port=_e.port,this.user=_e.user,this.password=_e.password,this._state=0,this._startCallbacks=[],this._autoClose=!1,this._socket=null,this._connectionTO=null,this._keepAliveIV=null,this._idleTO=null,this._reqID=0,this._requests=[],this._monitor=null,this._dataCallback=null,this._deviceParam=null;};return e.prototype.setDataCallback=function(e){this._dataCallback=e;},e.prototype.start=function(t){if(this._state!=e.STATE.ESTABLISHED){if(void 0!==t&&null!=t&&-1==this._startCallbacks.indexOf(t)&&this._startCallbacks.push(t),this._state==e.STATE.IDLE){this._logger.log("trace","start session "+this.ip);var i=this;this._state=e.STATE.CONNECT,this._connect(function(t){if(t){i._state=e.STATE.IDLE;for(var a=0;a<i._startCallbacks.length;a++){var n=i._startCallbacks[a];n&&n(t);}i._startCallbacks=[];}else i._state=e.STATE.LOGIN,i._login(function(t){var a=i._startCallbacks;i._startCallbacks=[],t?i.stop():(i._state=e.STATE.ESTABLISHED,i._keepAliveIV=setInterval(function(){i._keepAlive();},5e3),i._autoClose&&(i._idleTO=setTimeout(function(){i.stop();},6e4)));for(var n=0;n<a.length;n++){var o=a[n];o&&o(t);}});});}}else t&&t(null,this);},e.prototype.stop=function(t){this._state!=e.STATE.IDLE?(this._logger.log("trace","stop session "+this.ip),this._onSessionClose(),t&&t()):t&&t();},e.prototype.send=function(e,t){if(this._autoClose&&this._idleTO){var i=this;clearTimeout(this._idleTO),this._idleTO=setTimeout(function(){i.stop();},6e4);}this._logger.log("trace","send data: "+JSON.stringify(e)+" to "+this.ip),this._sendReq(e,t);},e.prototype._connect=function(e){var t=this,i=e;this._connectionTO=setTimeout(function(){i&&(i(new Error("connection timeout")),i=null);},2e3);var a="wss://".concat(this.ip,"/WebSocket"),n=require("websocket").createWebSocket(a);n.onclose=function(){if(i)return t._connectionTO&&(clearTimeout(t._connectionTO),t._connectionTO=null),i(new Error("connection failed")),void(i=null);t._onWsClose();},n.onerror=function(e){if(t._logger.log("error",e),i)return clearTimeout(t._connectionTO),t._connectionTO=null,i(new Error(e)),void(i=null);t._onWsError(new Error(e));},n.onmessage=function(e){t._onWsData(e);},n.onopen=function(){t._socket=n,t._connectionTO&&(clearTimeout(t._connectionTO),t._connectionTO=null),i&&(i(),i=null);},n.open();},e.prototype._login=function(t){var i=this;this._state=e.STATE.LOGIN,this._logger.log("trace","login with user:"+this.user+" password:"+this.password),this._sendReq({command:"login",user:this.user,password:this.password,long_life:!0},function(e,a){return e?(i._logger.log("warn","login error:"+e.message),void(t&&t(e))):a&&"ok"==a.status?void(t&&t()):(i._logger.log("warn","login failed:"+(a?a.status:"login response invalid")),(e=new Error(a?a.status:"login response invalid")).code=401,void(t&&t(e)));});},e.prototype._keepAlive=function(e){this._sendReq({id:512,command:"keepAlive",extend_session:!1},function(e,t){});},e.prototype._sendReq=function(e,t){e.id||(this._reqID++,this._reqID>=512&&(this._reqID=1),e.id=this._reqID);var i=this,a={req:e,callback:t,to:setTimeout(function(){var e=i._requests.indexOf(a);-1!=e&&i._requests.splice(e,1),t(new Error("request timeout"));},2e3)};this._requests.push(a),this._socket.sendJSON(e);},e.prototype._onSessionClose=function(t){if(this._state!=e.STATE.IDLE){var i,a;if(this._logger.log("trace","session closed "+this.ip),this._state=e.STATE.IDLE,t||(t=new Error("session stopped")),this._socket&&(this._socket.close(),this._socket=null),this._connectionTO&&(clearTimeout(this._connectionTO),this._connectionTO=null),this._keepAliveIV&&(clearInterval(this._keepAliveIV),this._keepAliveIV=null),this._startCallbacks)for(a=this._startCallbacks,this._startCallbacks=[],i=0;i<a.length;i++){var n=a[i];n&&n(t);}if(this._requests)for(a=this._requests,this._requests=[],i=0;i<a.length;i++){var o=a[i];o&&(o.to&&clearTimeout(o.to),o.callback&&o.callback(t));}this._dataCallback=null,this._deviceParam=null,void 0!==this._monitor&&null!=this._monitor&&this._monitor.onClose();}},e.prototype._onWsData=function(t){this._logger.log("trace","receive data: ".concat(t," from ").concat(this.ip));try{var i=JSON.parse(t);if(!i)return;var a=-1,n=null;for(var _e2=0;_e2<this._requests.length;_e2++){var _t=this._requests[_e2];_t&&_t.req&&_t.req.id==i.id&&("getDeviceParams"===_t.req.command&&(this._deviceParam=i.data),n=_t.callback,a=_e2,_t.to&&clearTimeout(_t.to));}a>-1&&this._requests.splice(a,1),"update"===i.status&&"deviceParams"===i.command&&i.data&&(this._deviceParam||(this._deviceParam={}),this._logger.log("trace","merging ".concat(JSON.stringify(i.data)," into ").concat(JSON.stringify(this._deviceParam))),this._deepMerge(this._deviceParam,i.data)),void 0!==this._monitor&&null!=this._monitor&&this._state==e.STATE.ESTABLISHED&&512!=i.id&&this._monitor.onData(i,this._deviceParam),n&&n(null,i),this._state==e.STATE.ESTABLISHED&&512!=i.id&&this._dataCallback&&this._dataCallback(i,this._deviceParam);}catch(t){this._logger.log("error",t.message);}},e.prototype._onWsError=function(e){this._logger.log("warn","websocket "+this.ip+" error:"+(e?e.message:"")),this._onSessionClose(e);},e.prototype._onWsClose=function(){this._logger.log("trace","websocket "+this.ip+" closed"),this._socket=null,this._onSessionClose(new Error("socket closed"));},e.prototype._deepMerge=function(e,t){if(!e)return t;if(!t)return e;var i=e;for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];this._isObject(n)?(e[a]=e[a]||{},this._deepMerge(e[a],t[a])):e[a]=t[a];}return i;},e.prototype._isObject=function(e){return e&&"object"==_typeof(e)&&!Array.isArray(e);},e.STATE={IDLE:0,CONNECT:1,LOGIN:2,ESTABLISHED:3},e;}(),xnm.aio.siegenia._SessionMonitor=function(){var e=function e(_e3){this._logger=require("x.logger.js").getLogger("xnm.aio.siegenia._SessionMonitor"),this._device=_e3,this._callbacks=[],this._session=null,this._running=!1,this._autoRestartTO=null;};return e.prototype.addCallback=function(e){e&&-1==this._callbacks.indexOf(e)&&this._callbacks.push(e);},e.prototype.start=function(e){if(this._autoRestartTO)return this._logger.log("trace","start monitor (restarting):"+this._device.ip),void(e&&e());this._logger.log("trace","start monitor:"+this._device.ip);var t=this;this._running=!0,xnm.aio.siegenia._SessionManager.startSession(this._device,function(i,a){if(i)return t._session=null,t._logger.log("warn","start monitor "+t._device.ip+" error:"+i.message+" code:"+i.code),void(t._running?(t._restart(i.code?120:30),e&&e(null,t)):e&&e(i));t._session=a,t._session._monitor=t,t._session.send({command:"getDeviceParams"},function(){}),e&&e(null,t);});},e.prototype.stop=function(e){this._logger.log("trace","stop monitor:"+this._device.ip),this._autoRestartTO&&(clearTimeout(this._autoRestartTO),this._autoRestartTO=null),this._running=!1;var t=xnm.aio.siegenia._SessionManager.getSession(this._device.ip);t?(t._monitor=null,t.stop(function(){e&&e();})):e&&e();},e.prototype._restart=function(e){this._logger.log("trace","restart monitor "+this._device.ip+" in "+e+"sec");var t=this;this._autoRestartTO=setTimeout(function(){t._running&&(t._logger.log("trace","restart monitor "+t._device.ip),t._autoRestartTO=null,t.start());},1e3*e);},e.prototype.onClose=function(){this._session=null,this._running&&this._restart();},e.prototype.onData=function(e,t){this._logger.log("trace","receive data:"+JSON.stringify(e));for(var i=0;i<this._callbacks.length;i++)this._callbacks[i](e,t);},e;}(),xnm.aio.siegenia._SessionManager={_sessions:{},_monitors:{},getSession:function getSession(e){return this._sessions[e];},setSession:function setSession(e,t){this._sessions[e]=t;},startSession:function startSession(e,t){if(e&&e.ip){var i=e.ip,a=this.getSession(i);void 0!==a&&null!=a||(a=new xnm.aio.siegenia._Session(e),this.setSession(i,a)),a.start(function(e){t&&t(e,a);});}else t&&t(new Error("ws device invalid"));},stopSession:function stopSession(e,t){if(e&&e.ip){var i=e.ip,a=this.getSession(i);void 0!==a&&null!=a||t&&t(),a.stop(function(e){t&&t(e);});}else t&&t(new Error("ws device invalid"));},startMonitorSession:function startMonitorSession(e,t,i){if(e&&e.ip){var a=e.ip;if(this._monitors[a])this._monitors[a].addCallback(t);else{var n=new xnm.aio.siegenia._SessionMonitor(e);n.addCallback(t);var o=this;n.start(function(e,t){e?i&&i(e):o._monitors[a]=t;});}}else i&&i(new Error("ws device invalid"));},stopMonitorSession:function stopMonitorSession(e,t){if(console.log("=======>","stop monitor session"),e&&e.ip){var i=e.ip;if(this._monitors[i]){var a=this._monitors[i],n=this;a.stop(function(){n._monitors[i]=null,t&&t();});}else t&&t();}else t&&t(new Error("ws device invalid"));}},xnm.aio.siegenia._IQONTROLStateCallbacks={},xnm.aio.siegenia.WSDevice=function(){var e=function e(){this.ip=null,this.port=443,this.user="user",this.password="0000",this._data=null,this._type=null,this._variant=null,this._subvariant=null,this._serial=null;};return e.prototype.CONNECTION_ERROR=513,e.prototype.connect=function(e){var t=this;xnm.aio.siegenia._SessionManager.startSession(this,function(i,a){i?e&&e(i):(t._session=a,e&&e(null,a));});},e.prototype.send=function(e,t,i){e?e.send(t,function(e,t){e?i&&i(e):t&&"ok"==t.status?i&&i(null,t.data):i&&i(new Error(t?t.status:"response invalid"));}):i&&i(new Error("session invalid"));},e.prototype.disconnect=function(e){xnm.aio.siegenia._SessionManager.stopSession(this,function(t){e&&e(t);});},e.prototype.startMonitoring=function(e,t){var i=this;xnm.aio.siegenia._SessionManager.startMonitorSession(this,function(t,a){var n=i._resolveData(t,a);n&&e(n);},function(e){t&&t(e);});},e.prototype._resolveData=function(e,t){var i=null;return e&&512!=e.id&&e.data&&!e.data.token&&t&&(i=this.computeStates(t)),i;},e.prototype.toJSON=function(){return{sys:"siegenia",ip:this.ip,port:this.port,username:this.user,password:this.password,data:this._data,type:this._type,variant:this._variant,subvariant:this._subvariant,serial:this._serial};},e.prototype.equalsTo=function(e){return!!e&&e instanceof xnm.aio.siegenia.WSDevice&&this.ip==e.ip&&this.port==e.port;},e;}(),xnm.aio.siegenia.Genius=function(e,t,i,a,n){this.ip=e,t&&(this.user=t),i&&(this.password=i),n&&(this.port=n),this.type="B",a&&(this.type=a);var o=this;this._dataCallback=function(e,t){var i=o._resolveData(e,t),a=xnm.aio.siegenia._IQONTROLStateCallbacks[o.ip];i&&a&&a.id&&a.ch&&o._doStateCallback(a.id,a.ch,i);};},xnm.aio.siegenia.Genius.prototype=new xnm.aio.siegenia.WSDevice(),xnm.aio.siegenia.Genius.prototype.constructor=xnm.aio.siegenia.Genius,xnm.aio.siegenia.Genius.prototype.CMD_GETDEVICE=256,xnm.aio.siegenia.Genius.prototype.CMD_KEEPALIVE=257,xnm.aio.siegenia.Genius.prototype.CMD_GETPARAMS=258,xnm.aio.siegenia.Genius.prototype.CMD_OPEN=259,xnm.aio.siegenia.Genius.prototype.CMD_CLOSE=260,xnm.aio.siegenia.Genius.prototype.CMD_SETDAYMODE=261,xnm.aio.siegenia.Genius.prototype.CMD_SETNIGHTMODE=262,xnm.aio.siegenia.Genius.prototype.CMD_IMPULSE_ON=263,xnm.aio.siegenia.Genius.prototype.CMD_IMPULSE_OFF=264,xnm.aio.siegenia.Genius.prototype.CMD_SETIMPULSE=265,xnm.aio.siegenia.Genius.prototype.CMD_SETTIMER=266,xnm.aio.siegenia.Genius.prototype.CMD_POSITION1=267,xnm.aio.siegenia.Genius.prototype.CMD_POSITION2=268,xnm.aio.siegenia.Genius.prototype.CMD_LOCK=269,xnm.aio.siegenia.Genius.prototype.CMD_STOPTIMER=270,xnm.aio.siegenia.Genius.prototype.CMD_STOP=271,xnm.aio.siegenia.Genius.prototype.CMD_STARTTIMER=272,xnm.aio.siegenia.Genius.prototype.CMD_WING1_OPEN=273,xnm.aio.siegenia.Genius.prototype.CMD_WING1_CLOSE=274,xnm.aio.siegenia.Genius.prototype.CMD_WING1_POSITION1=275,xnm.aio.siegenia.Genius.prototype.CMD_WING1_POSITION2=276,xnm.aio.siegenia.Genius.prototype.CMD_WING1_STOP=277,xnm.aio.siegenia.Genius.prototype.CMD_WING1_LOCK=278,xnm.aio.siegenia.Genius.prototype.CMD_WING2_OPEN=279,xnm.aio.siegenia.Genius.prototype.CMD_WING2_CLOSE=280,xnm.aio.siegenia.Genius.prototype.CMD_WING2_STOP=281,xnm.aio.siegenia.Genius.prototype.CMD_WING2_LOCK=282,xnm.aio.siegenia.Genius.prototype.CMD_SET_STOPOVER=288,xnm.aio.siegenia.Genius.prototype.CMD_OPEN_TO_TURN=289,xnm.aio.siegenia.Genius.prototype.CMD_SILENT_ON=290,xnm.aio.siegenia.Genius.prototype.CMD_SILENT_OFF=291,xnm.aio.siegenia.Genius.prototype.execute=function(e,t,i){var a=this,n=null;if(e==this.CMD_KEEPALIVE)n={command:"keepAlive",extend_session:!1};else if(e==this.CMD_GETDEVICE)n={command:"getDevice"};else if(e==this.CMD_GETPARAMS)n={command:"getDeviceParams"};else if(e==this.CMD_OPEN)n={command:"setDeviceParams"},"axxentDK"==this.type?n.params={openclose:"OPEN"}:"axxentHSA"==this.type?n.params={openclose:{0:"OPEN"}}:"axxentHSA2"==this.type?n.params={openclose:{0:"OPEN",1:"OPEN"}}:n.params={relais1:!0};else if(e==this.CMD_CLOSE){if(n={command:"setDeviceParams"},"axxentDK"==this.type)n.params={openclose:"CLOSE"};else if("axxentHSA"==this.type)n.params={openclose:{0:"CLOSE_WO_LOCK"}};else{if("axxentHSA2"==this.type)return void this.execute(this.CMD_WING1_CLOSE,null,function(e,t){e?i&&i(e,t):a.execute(a.CMD_WING2_CLOSE,null,function(e,t){i&&i(e,t);});});"mh10"==this.type?n.params={relais2:!0}:n.params={relais1:!1};}}else if(e==this.CMD_OPEN_TO_TURN)n={command:"setDeviceParams"},"axxentDK"==this.type&&(n.params={openclose:"OPEN_TO_TURN"});else if(e==this.CMD_STOP)(n={command:"setDeviceParams"}).params={stop:!0},"axxentHSA"==this.type&&(n.params={stop:{0:"true"}}),"axxentHSA2"==this.type&&(n.params={stop:{0:"true",1:"true"}});else if(e==this.CMD_LOCK)n={command:"setDeviceParams",params:{openclose:"CLOSE"}},"axxentHSA"!=this.type&&"axxentHSA2"!=this.type||(n.params={openclose:{0:"CLOSE"}});else if(e==this.CMD_POSITION1)n={command:"setDeviceParams",params:{openclose:{0:"STOP_OVER"}}};else if(e==this.CMD_POSITION2)n={command:"setDeviceParams",params:{openclose:{0:"GAP_VENT"}}};else if(e==this.CMD_SETDAYMODE)n={command:"setDeviceParams",params:{relais2:!0}};else if(e==this.CMD_SETNIGHTMODE)n={command:"setDeviceParams",params:{relais2:!1}};else if(e==this.CMD_IMPULSE_ON)n={command:"setDeviceParams",params:{impulse:!0}};else if(e==this.CMD_IMPULSE_OFF)n={command:"setDeviceParams",params:{impulse:!1}};else if(e==this.CMD_SETIMPULSE)n={command:"setDeviceParams",params:{impulseduration:t}};else if(e==this.CMD_SETTIMER){var o=t.indexOf(":"),s=0,r=t;-1!=o&&(s=t.substr(0,o),r=t.substr(o+1)),s=parseInt(s),r=parseInt(r),n={command:"setDeviceParams",params:{timer:{duration:{hour:s,minute:r}}}};}else e==this.CMD_STOPTIMER?n={command:"setDeviceParams",params:{timer:{enabled:!1}}}:e==this.CMD_STARTTIMER?n={command:"setDeviceParams",params:{timer:{enabled:!0}}}:e==this.CMD_WING1_OPEN?n={command:"setDeviceParams",params:{openclose:{0:"OPEN"}}}:e==this.CMD_WING1_CLOSE?n={command:"setDeviceParams",params:{openclose:{0:"CLOSE_WO_LOCK"}}}:e==this.CMD_WING1_STOP?n={command:"setDeviceParams",params:{stop:{0:!0}}}:e==this.CMD_WING1_POSITION1?n={command:"setDeviceParams",params:{openclose:{0:"STOP_OVER"}}}:e==this.CMD_WING1_POSITION2?n={command:"setDeviceParams",params:{openclose:{0:"GAP_VENT"}}}:e==this.CMD_WING1_LOCK?n={command:"setDeviceParams",params:{openclose:{0:"CLOSE"}}}:e==this.CMD_WING2_OPEN?n={command:"setDeviceParams",params:{openclose:{1:"OPEN"}}}:e==this.CMD_WING2_CLOSE?n={command:"setDeviceParams",params:{openclose:{1:"CLOSE_WO_LOCK"}}}:e==this.CMD_WING2_STOP?n={command:"setDeviceParams",params:{stop:{1:!0}}}:e==this.CMD_WING2_LOCK?n={command:"setDeviceParams",params:{openclose:{1:"CLOSE"}}}:e==this.CMD_SET_STOPOVER?((s=Math.round(parseInt(t)/10))<3&&(s=3),n={command:"setDeviceParams",params:{stopover:s}}):e==this.CMD_SILENT_ON?n={command:"setDeviceParams",params:{silent_state:!0}}:e==this.CMD_SILENT_OFF&&(n={command:"setDeviceParams",params:{silent_state:!1}});n?(a=this,this.connect(function(e,t){if(e)return e.code=a.CONNECTION_ERROR,void(i&&i(e));t.setDataCallback(a._dataCallback),a.send(t,n,function(e,t){setTimeout(function(){i&&i(e,t);},250);});})):i&&i(new Error("no such command"));},xnm.aio.siegenia.Genius.prototype.getDevice=function(e){this.execute(this.CMD_GETDEVICE,null,function(t,i){e&&e(t,i);});},xnm.aio.siegenia.Genius.prototype.getState=function(e){this.execute(this.CMD_GETPARAMS,null,function(t,i){e&&e(t,i);});},xnm.aio.siegenia.Genius.prototype.executeCommand=function(e,t,i){var a=null,n=null;"keepAlive"==t?a=this.CMD_KEEPALIVE:"nightmode"==t?a=this.CMD_SETNIGHTMODE:"daymode"==t?a=this.CMD_SETDAYMODE:"open"==t?a=this.CMD_OPEN:"close"==t?a=this.CMD_CLOSE:"open_to_turn"==t?a=this.CMD_OPEN_TO_TURN:"stop"==t?a=this.CMD_STOP:"position1"==t?a=this.CMD_POSITION1:"position2"==t?a=this.CMD_POSITION2:"lock"==t?a=this.CMD_LOCK:"impulseOn"==t?a=this.CMD_IMPULSE_ON:"impulseOff"==t?a=this.CMD_IMPULSE_OFF:"startTimer"==t?a=this.CMD_STARTTIMER:"stopTimer"==t?a=this.CMD_STOPTIMER:"setImpulse"==t.substr(0,10)?(t=t.replace(/setImpulse/g,""),a=this.CMD_SETIMPULSE,(n=parseInt(t))<0?n=0:n>86400&&(n=86400)):"wing1open"==t?a=this.CMD_WING1_OPEN:"wing1close"==t?a=this.CMD_WING1_CLOSE:"wing1stop"==t?a=this.CMD_WING1_STOP:"wing1lock"==t?a=this.CMD_WING1_LOCK:"wing1position1"==t?a=this.CMD_WING1_POSITION1:"wing1position2"==t?a=this.CMD_WING1_POSITION2:"wing2open"==t?a=this.CMD_WING2_OPEN:"wing2close"==t?a=this.CMD_WING2_CLOSE:"wing2stop"==t?a=this.CMD_WING2_STOP:"wing2lock"==t?a=this.CMD_WING2_LOCK:"silentOn"==t?a=this.CMD_SILENT_ON:"silentOff"==t?a=this.CMD_SILENT_OFF:"setTimer"==t.substr(0,8)?(a=this.CMD_SETTIMER,n=t=t.replace(/setTimer/g,"")):"setStopover"==t.substr(0,11)&&(a=this.CMD_SET_STOPOVER,n=t=t.replace(/setStopover/g,"")),a?this.execute(a,n,function(e,t){i(e,t);}):i&&i();},xnm.aio.siegenia.Genius.prototype.computeStates=function(e){var t={};if("mh10"===this.type?1==e.relais1?t.state="open":1==e.relais2&&(t.state="closed"):0==e.relais1?t.state="closed":1==e.relais1&&(t.state="open"),"axxentDK"===this.type)"OPEN"===e.state?t.state="open":"CLOSED"===e.state?t.state="closed":"MOVING"===e.state?t.state="moving":t.state=e.state.toLowerCase(),1==e.silent_state?t.silent_state="on":t.silent_state="off";else if("axxentHSA"===this.type&&e.states)switch(e.states[0]){case"OPEN":t.state="open";break;case"CLOSED_WO_LOCK":t.state="closed";break;case"CLOSED":t.state="locked";break;case"GAP_VENT":t.state="gap";break;case"STOP_OVER":t.state="stopover";break;case"STOPPED":t.state="stop";break;case"MOVING":t.state="moving";}else if("axxentHSA2"===this.type&&e.states){switch(e.states[0]){case"OPEN":t.wing1state="open";break;case"CLOSED_WO_LOCK":t.wing1state="closed";break;case"CLOSED":t.wing1state="locked";break;case"GAP_VENT":t.wing1state="gap";break;case"STOP_OVER":t.wing1state="stopover";break;case"STOPPED":t.wing1state="stop";break;case"MOVING":t.wing1state="moving";}switch(e.states[1]){case"OPEN":t.wing2state="open";break;case"CLOSED_WO_LOCK":t.wing2state="closed";break;case"CLOSED":t.wing2state="locked";break;case"GAP_VENT":t.wing2state="gap";break;case"STOP_OVER":t.wing2state="stopover";break;case"STOPPED":t.wing2state="stop";break;case"MOVING":t.wing2state="moving";}}else"B"===this.type&&(1==e.relais2?t.mode="day":0==e.relais2&&(t.mode="night"),"night"===t.mode&&"closed"===t.state&&(t.state="locked"));return void 0!==e.stopover&&null!=e.stopover&&(t.stopover=10*parseInt(e.stopover)),t.maxStopover=e.max_stopover,e.timer&&(1==e.timer.enabled?t.timerEnabled="enabled":0==e.timer.enabled&&(t.timerEnabled="disabled"),e.timer.duration&&(t.duration=(e.timer.duration.hour<10?"0":"")+e.timer.duration.hour+":"+(e.timer.duration.minute<10?"0":"")+e.timer.duration.minute,t.durationM=60*parseInt(e.timer.duration.hour,10)+parseInt(e.timer.duration.minute,10)),e.timer.remainingtime&&(t.remainingTime=(e.timer.remainingtime.hour<10?"0":"")+e.timer.remainingtime.hour+":"+(e.timer.remainingtime.minute<10?"0":"")+e.timer.remainingtime.minute,t.remainingTimeM=60*parseInt(e.timer.remainingtime.hour,10)+parseInt(e.timer.remainingtime.minute,10))),"mh10"!==this.type&&(1==e.impulse?t.impulse="enabled":0==e.impulse&&(t.impulse="disabled"),void 0!==e.impulseduration&&(t.impulseduration=e.impulseduration)),e.warnings&&(t.warnings=e.warnings),"OPEN"===e.state?t.state="open":"CLOSED"===e.state&&(t.state="closed"),t;},xnm.aio.siegenia.Genius.prototype.getStates=function(e,t,i){var a=this;t&&t.id&&e&&(xnm.aio.siegenia._IQONTROLStateCallbacks[this.ip]={id:t?t.id:null,ch:e}),this.getState(function(n,o){var s=null;if(n?s={error:n.message}:o&&(s=a.computeStates(o)),s&&a._doStateCallback(t?t.id:null,e,s),i&&s){var r=s;s=null,i(r);}});},xnm.aio.siegenia.Genius.prototype.getStateValues=function(e){return e;},xnm.aio.siegenia.Genius.prototype._doStateCallback=function(e,t,i){if(i.error||(i.error=""),e&&t&&t.setState)for(var a in i.state&&t.setState(e,i.state),i)"state"!=a&&"warnings"!=a?t.setState(e+":"+a,i[a]):"warnings"==a&&i[a]&&t.setState(e+":warnings",i[a].toString());else t&&t.receivedState&&t.receivedState("siegenia",this.ip,i);},xnm.aio.siegenia.Genius.prototype.executeCommandCreator=function(e,t,i){if(t&&t.value){var a=t.value;switch(a){case"setImpulse":case"setTimer":case"setStopover":if(void 0===t.ext||null==t.ext)return void(i&&i(new Error("command ext invalid")));a+=t.ext;}this.executeCommand(e,a,function(e){i&&i(e);});}else i&&i(new Error("command value is empty"));},xnm.aio.siegenia.Genius.prototype.getStatesCreator=function(e,t,i){var a=this;this._getState(function(e,n){if(n){var o=null;e?o={error:e.message}:n&&(o=a.computeStates(n));for(var s=[],r=0;r<t.length;r++){var u=t[r];if(u&&u.id&&u.status&&u.status.value){var m=o[u.status.value];void 0!==m&&null!=m&&s.push({id:u.id,status:m});}}i&&i(null,s);}else i&&i(new Error("get state error"));});},xnm.aio.siegenia.Genius.prototype.getSingleDeviceStatesCreator=function(e,t,i,a){var n=this;this._getState(function(e,t){if(t){var i=null;e?i={error:e.message}:t&&(i=n.computeStates(t)),a&&a(null,i);}else a&&a(new Error("get state error"));});},xnm.aio.siegenia.Genius.prototype._getState=function(e){var t=this;this.connect(function(i,a){if(i)return i.code=t.CONNECTION_ERROR,void(e&&e(i));a&&a._deviceParam?e&&e(null,a._deviceParam):t.send(a,{command:"getDeviceParams"},function(t,i){setTimeout(function(){e&&e(t,i);},250);});});},xnm.aio.siegenia.AEROPAC=function(e,t,i,a,n){this.ip=e,t&&(this.user=t),i&&(this.password=i),n&&(this.port=n),this.type="aeropac",a&&(this.type=a),this.CommandHandler=null;var o=this;this._dataCallback=function(e,t){var i=o._resolveData(e,t),a=xnm.aio.siegenia._IQONTROLStateCallbacks[o.ip];i&&a&&a.id&&a.ch&&o._doStateCallback(a.id,a.ch,i);};},xnm.aio.siegenia.AEROPAC.prototype=new xnm.aio.siegenia.WSDevice(),xnm.aio.siegenia.AEROPAC.prototype.constructor=xnm.aio.siegenia.Genius,xnm.aio.siegenia.AEROPAC.prototype.CMD_KEEPALIVE=257,xnm.aio.siegenia.AEROPAC.prototype.CMD_GETPARAMS=258,xnm.aio.siegenia.AEROPAC.prototype.CMD_GETSTATE=259,xnm.aio.siegenia.AEROPAC.prototype.CMD_ON=260,xnm.aio.siegenia.AEROPAC.prototype.CMD_OFF=261,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANLEVEL=262,xnm.aio.siegenia.AEROPAC.prototype.CMD_AUTOMODE_ON=263,xnm.aio.siegenia.AEROPAC.prototype.CMD_AUTOMODE_OFF=264,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANPOWER=265,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETAUTOFANPOWER=266,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANMODE_IN=267,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANMODE_OUT=268,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANMODE_INOUT=269,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETFANMODE_INOUT_WRG=270,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETSENSORSENSITIVITY=271,xnm.aio.siegenia.AEROPAC.prototype.CMD_SETTIMER=272,xnm.aio.siegenia.AEROPAC.prototype.CMD_STOPTIMER=273,xnm.aio.siegenia.AEROPAC.prototype.CMD_STARTTIMER=274,xnm.aio.siegenia.AEROPAC.prototype.CMD_SET_DAILYTIMER=275,xnm.aio.siegenia.AEROPAC.prototype.CMD_START_DAILYTIMER=276,xnm.aio.siegenia.AEROPAC.prototype.CMD_STOP_DAILYTIMER=277,xnm.aio.siegenia.AEROPAC.prototype.CMD_LEDS_ON=278,xnm.aio.siegenia.AEROPAC.prototype.CMD_LEDS_OFF=279,xnm.aio.siegenia.AEROPAC.prototype.CMD_ADD_TIMER=280,xnm.aio.siegenia.AEROPAC.prototype.CMD_DELETE_TIMER=281,xnm.aio.siegenia.AEROPAC.prototype.CMD_UPDATE_TIMER=288,xnm.aio.siegenia.AEROPAC.prototype.execute=function(e,t,i){var a=null;if(e==this.CMD_KEEPALIVE)a={command:"keepAlive",extend_session:!1};else if(e==this.CMD_GETPARAMS)a={command:"getDeviceParams"};else if(e==this.CMD_GETSTATE)a={command:"getDeviceState"};else if(e==this.CMD_ON)a={command:"setDeviceParams",params:{devicestate:{deviceactive:!0}}};else if(e==this.CMD_OFF)a={command:"setDeviceParams",params:{devicestate:{deviceactive:!1}}};else if(e==this.CMD_LEDS_ON)a={command:"setDeviceParams",params:{leds:!0}};else if(e==this.CMD_LEDS_OFF)a={command:"setDeviceParams",params:{leds:!1}};else if(e==this.CMD_SETFANLEVEL)a={command:"setDeviceParams",params:{devicestate:{deviceactive:!0},fanlevel:t}};else if(e==this.CMD_SETFANPOWER)a={command:"setDeviceParams",params:{devicestate:{deviceactive:!0},fanpower:t}};else if(e==this.CMD_SETAUTOFANPOWER)a={command:"setDeviceParams",params:{automode_maxairflow:t}};else if(e==this.CMD_SETSENSORSENSITIVITY)a={command:"setDeviceParams",params:{automode_co2sensity:t}};else if(e==this.CMD_AUTOMODE_ON)a={command:"setDeviceParams",params:{automode:!0}};else if(e==this.CMD_AUTOMODE_OFF)a={command:"setDeviceParams",params:{automode:!1}};else if(e==this.CMD_SETFANMODE_IN)a={command:"setDeviceParams",params:{fanmode:"IN"}};else if(e==this.CMD_SETFANMODE_OUT)a={command:"setDeviceParams",params:{fanmode:"OUT"}};else if(e==this.CMD_SETFANMODE_INOUT)a={command:"setDeviceParams",params:{fanmode:"IN_OUT"}};else if(e==this.CMD_SETFANMODE_INOUT_WRG)a={command:"setDeviceParams",params:{fanmode:"IN_OUT_WRG"}};else if(e==this.CMD_SETTIMER){var n=-1,o=t,s=0;t.indexOf&&(n=t.indexOf(":")),-1!=n&&(o=t.substr(0,n),s=t.substr(n+1)),o=parseInt(o),s=parseInt(s),a={command:"setDeviceParams",params:{timer:{duration:{hour:o,minute:s}}}};}else e==this.CMD_STOPTIMER?a={command:"setDeviceParams",params:{timer:{enabled:!1}}}:e==this.CMD_STARTTIMER?a={command:"setDeviceParams",params:{timer:{enabled:!0}}}:e==this.CMD_SET_DAILYTIMER?(n=t.indexOf(":"),o=t,s=0,-1!=n&&(o=t.substr(0,n),s=t.substr(n+1)),o=parseInt(o),s=parseInt(s),a={command:"setDeviceParams",params:{timer:{poweron_time:{hour:o,minute:s}}}}):e==this.CMD_START_DAILYTIMER?a={command:"setDeviceParams",params:{timer:{repeat:!0}}}:e==this.CMD_STOP_DAILYTIMER?a={command:"setDeviceParams",params:{timer:{repeat:!1}}}:(e==this.CMD_ADD_TIMER||e==this.CMD_DELETE_TIMER||e==this.CMD_UPDATE_TIMER)&&(a={command:"setDeviceParams",params:{timer:t}});if(a){var r=this;this.connect(function(e,t){if(e)return e.code=r.CONNECTION_ERROR,void(i&&i(e));t.setDataCallback(r._dataCallback),r.send(t,a,function(e,t){setTimeout(function(){i&&i(e,t);},250);});});}else i&&i(new Error("no such command"));},xnm.aio.siegenia.AEROPAC.prototype.getState=function(e){this.execute(this.CMD_GETPARAMS,null,function(t,i){e&&e(t,i);});},xnm.aio.siegenia.AEROPAC.prototype.executeCommand=function(e,t,i){var a=null,n=null;"keepAlive"==t?a=this.CMD_KEEPALIVE:"on"==t?a=this.CMD_ON:"off"==t?a=this.CMD_OFF:"ledsOn"==t?a=this.CMD_LEDS_ON:"ledsOff"==t?a=this.CMD_LEDS_OFF:"automodeOn"==t?a=this.CMD_AUTOMODE_ON:"automodeOff"==t?a=this.CMD_AUTOMODE_OFF:"fanmodeIn"==t?a=this.CMD_SETFANMODE_IN:"fanmodeOut"==t?a=this.CMD_SETFANMODE_OUT:"fanmodeInOut"==t?a=this.CMD_SETFANMODE_INOUT:"fanmodeInOutWRG"==t?a=this.CMD_SETFANMODE_INOUT_WRG:"startTimer"==t?a=this.CMD_STARTTIMER:"stopTimer"==t?a=this.CMD_STOPTIMER:0==t.indexOf("setTimer")?(a=this.CMD_SETTIMER,-1!=(t=t.replace(/setTimer/g,"")).indexOf(":")?n=t:((n=parseInt(t))<1&&(n=1),n>18&&(n=18))):"startDailyPowerOn"==t?a=this.CMD_START_DAILYTIMER:"stopDailyPowerOn"==t?a=this.CMD_STOP_DAILYTIMER:0==t.indexOf("setDailyPowerOn")?(a=this.CMD_SET_DAILYTIMER,n=t=t.replace(/setDailyPowerOn/g,"")):(0==t.indexOf("setTo")?(a=this.CMD_SETFANPOWER,t=t.replace(/setTo/g,"")):0==t.indexOf("setAutoTo")?(a=this.CMD_SETAUTOFANPOWER,t=t.replace(/setAutoTo/g,"")):0==t.indexOf("setSensorTo")&&(a=this.CMD_SETSENSORSENSITIVITY,t=t.replace(/setSensorTo/g,"")),n=parseInt(t),"aerotube"==this.type?(n<15&&(n=15),n>100&&(n=100)):"aerovital"==this.type?(n<0&&(n=0),n>100&&(n=100)):"aeromatVT"==this.type?(a=this.CMD_SETFANPOWER,0==n&&(n=1),n>100&&(n=100)):(a=this.CMD_SETFANLEVEL,n>7&&(n=7))),a?this.execute(a,n,function(e,t){i(e,t);}):i&&i();},xnm.aio.siegenia.AEROPAC.prototype.computeStates=function(e){var t={};if(t={},1==e.automode?t.automode="on":0==e.automode&&(t.automode="off"),void 0!==e.airquality&&null!=e.airquality&&(t.airquality=""+e.airquality),null!=e.fanpower&&("aerotube"==this.type?t.fanpower=(e.fanpower/100*45).toFixed(1):"aerovital"==this.type?t.fanpower=(e.fanpower/100*60).toFixed(1):t.fanpower=(e.fanpower/100*21).toFixed(1),0==e.fanpower?1==t.automode?t.state="on":t.state="off":t.state="on"),null!=e.fanlevel&&(t.fanlevel=""+e.fanlevel,0==e.fanlevel?t.state="off":t.state="on"),e.devicestate&&null!=e.devicestate.deviceactive&&(1==e.devicestate.deviceactive?t.state="on":t.state="off"),e.automode_maxairflow&&("aerotube"==this.type?t.autoairflow=(e.automode_maxairflow/100*45).toFixed(1):"aerovital"==this.type&&(t.autoairflow=(e.automode_maxairflow/100*60).toFixed(1))),null!=e.automode_co2sensity&&(t.autosensitivity=""+e.automode_co2sensity),null!=e.fanmode&&(t.fanmode=e.fanmode.toLowerCase()),e.timer){t.activeTimer=e.timer.activetimer;var i,a,n=[];e.timer.timer_valid>>7&1&&n.push(1),e.timer.timer_valid>>6&1&&n.push(2),e.timer.timer_valid>>5&1&&n.push(3),e.timer.timer_valid>>4&1&&n.push(4),e.timer.timer_valid>>3&1&&n.push(5),t.validTimers=n,1==e.timer.enabled?t.timerEnabled="enabled":0==e.timer.enabled&&(t.timerEnabled="disabled"),e.timer.remainingtime&&(t.remainingTimeM=60*parseInt(e.timer.remainingtime.hour)+parseInt(e.timer.remainingtime.minute),e.timer.remainingtime.minute<10?t.remainingTime=e.timer.remainingtime.hour+":0"+e.timer.remainingtime.minute:t.remainingTime=e.timer.remainingtime.hour+":"+e.timer.remainingtime.minute),1==e.timer.repeat?t.dailyPowerOnEnabled="enabled":0==e.timer.repeat&&(t.dailyPowerOnEnabled="disabled"),e.timer.poweron_time&&((i=e.timer.poweron_time.hour+"").length<2&&(i="0"+i),(a=e.timer.poweron_time.minute+"").length<2&&(a="0"+a),t.dailyPowerOnTime=i+":"+a),e.timer.duration&&((i=e.timer.duration.hour+"").length<2&&(i="0"+i),(a=e.timer.duration.minute+"").length<2&&(a="0"+a),t.duration=i+":"+a,t.durationH=parseInt(e.timer.duration.hour));}if(e.list_timers){t.timers=[];for(var o=0;o<e.list_timers.length;o++){var s=e.list_timers[o],r=s;for("object"==_typeof(s.duration)&&((i=s.duration.hour+"").length<2&&(i="0"+i),(a=s.duration.minute+"").length<2&&(a="0"+a),r.duration=i+":"+a),"object"==_typeof(s.poweron_time)&&((i=s.poweron_time.hour+"").length<2&&(i="0"+i),(a=s.poweron_time.minute+"").length<2&&(a="0"+a),r.poweron_time=i+":"+a),r.poweron_weekday=s.poweron_weekday.toString(2);r.poweron_weekday.length<7;)r.poweron_weekday="0"+r.poweron_weekday;t.timers.push(r);}}return e.airbase&&(e.airbase.humidity||e.airbase.temperature)&&(e.airbase.temperature&&e.airbase.temperature.indoor&&(t.indoorTemp=e.airbase.temperature.indoor.toFixed(1)),e.airbase.temperature&&e.airbase.temperature.outdoor&&(t.outdoorTemp=e.airbase.temperature.outdoor.toFixed(1)),e.airbase.humidity&&e.airbase.humidity.indoor&&(t.indoorHum=e.airbase.humidity.indoor.toFixed(1)),e.airbase.humidity&&e.airbase.humidity.outdoor&&(t.outdoorHum=e.airbase.humidity.outdoor.toFixed(1))),void 0!==e.leds&&null!=e.leds&&(t.leds=e.leds?"on":"off"),e.warnings&&(t.warnings=e.warnings),t;},xnm.aio.siegenia.AEROPAC.prototype.getStates=function(e,t,i){var a=this;t&&t.id&&e&&(xnm.aio.siegenia._IQONTROLStateCallbacks[this.ip]={id:t?t.id:null,ch:e}),this.getState(function(n,o){var s=null;if(n?s={error:n.message}:o&&(a.state=o,s=a.computeStates(o)),s&&a._doStateCallback(t?t.id:null,e,s),i&&s){var r=s;s=null,i(r);}});},xnm.aio.siegenia.AEROPAC.prototype.getStateValues=function(e){return e;},xnm.aio.siegenia.AEROPAC.prototype._doStateCallback=function(e,t,i){if(i.error||(i.error=""),e&&t&&t.setState)for(var a in i.state&&t.setState(e,i.state),i)"state"!=a&&"warnings"!=a?t.setState(e+":"+a,i[a]):"warnings"==a&&i[a]&&t.setState(e+":warnings",i[a].toString());else t&&t.receivedState&&t.receivedState("siegenia",this.ip,i);},xnm.aio.siegenia.AEROPAC.prototype.addTimer=function(e,t){var i=e;if(e.duration){var a=e.duration.split(":")[0],n=e.duration.split(":")[1];i.duration={hour:parseInt(a),minute:parseInt(n)};}e.poweron_time&&(a=e.poweron_time.split(":")[0],n=e.poweron_time.split(":")[1],i.poweron_time={hour:parseInt(a),minute:parseInt(n)}),e.poweron_weekday&&(i.poweron_weekday=parseInt(e.poweron_weekday,2)),this.execute(this.CMD_ADD_TIMER,i,t);},xnm.aio.siegenia.AEROPAC.prototype.deleteTimer=function(e,t){if(e.timer_id){var i={timer_delete:!0,timer_id:e.timer_id};this.execute(this.CMD_DELETE_TIMER,i,t);}else t&&t(new Error("no timer id"));},xnm.aio.siegenia.AEROPAC.prototype.updateTimer=function(e,t){if(e.timer_id){var i=e;if(e.duration){var a=e.duration.split(":")[0],n=e.duration.split(":")[1];i.duration={hour:parseInt(a),minute:parseInt(n)};}e.poweron_time&&(a=e.poweron_time.split(":")[0],n=e.poweron_time.split(":")[1],i.poweron_time={hour:parseInt(a),minute:parseInt(n)}),e.poweron_weekday&&(i.poweron_weekday=parseInt(e.poweron_weekday,2)),this.execute(this.CMD_UPDATE_TIMER,i,t);}else t&&t(new Error("no timer id"));},xnm.aio.siegenia.AEROPAC.prototype.executeCommandCreator=function(e,t,i){if(t&&t.value){var a,n=t.value;switch(n){case"setTo":if(void 0===t.ext||null==t.ext)return void(i&&i(new Error("command ext invalid")));a=parseInt(t.ext),"aeromatVT"==this.type&&(a=Math.round(parseInt(t.ext)/21*100)),"aerovital"==this.type&&(a=Math.round(parseInt(t.ext)/60*100)),"aerotube"==this.type&&(a=Math.round(parseInt(t.ext)/45*100)),n+=a;break;case"setAutoTo":if(void 0===t.ext||null==t.ext)return void(i&&i(new Error("command ext invalid")));a=parseInt(t.ext),"aerovital"==this.type&&(a=Math.round(parseInt(t.ext)/60*100)),"aerotube"==this.type&&(a=Math.round(parseInt(t.ext)/45*100)),n+=a;break;case"setSensorTo":if(void 0===t.ext||null==t.ext)return void(i&&i(new Error("command ext invalid")));n+=a=parseInt(t.ext);break;case"setTimer":case"setDailyPowerOn":if(void 0===t.ext||null==t.ext)return void(i&&i(new Error("command ext invalid")));n+=a=t.ext;}this.executeCommand(e,n,function(e){i&&i(e);});}else i&&i(new Error("command value is empty"));},xnm.aio.siegenia.AEROPAC.prototype.getStatesCreator=function(e,t,i){var a=this;this._getState(function(e,n){if(n){var o=null;e?o={error:e.message}:n&&(o=a.computeStates(n));for(var s=[],r=0;r<t.length;r++){var u=t[r];if(u&&u.id&&u.status&&u.status.value){var m=o[u.status.value];void 0!==m&&null!=m&&s.push({id:u.id,status:m});}}i&&i(null,s);}else i&&i(new Error("get state error"));});},xnm.aio.siegenia.AEROPAC.prototype.getSingleDeviceStatesCreator=function(e,t,i,a){var n=this;this._getState(function(e,t){if(t){var i=null;e?i={error:e.message}:t&&(i=n.computeStates(t)),a&&a(null,i);}else a&&a(new Error("get state error"));});},xnm.aio.siegenia.AEROPAC.prototype._getState=function(e){var t=this;this.connect(function(i,a){if(i)return i.code=t.CONNECTION_ERROR,void(e&&e(i));a&&a._deviceParam?e&&e(null,a._deviceParam):t.send(a,{command:"getDeviceParams"},function(t,i){setTimeout(function(){e&&e(t,i);},250);});});},xnm.aio.siegenia.RulesManager=function(){},xnm.aio.siegenia.RulesManager.prototype.getOperations=function(e,t,i,a){i||(i="trigger"),a||(a="state");var n,o=[];return"sensoair"==t?(n={trigger:[window.XC_Text["<="],window.XC_Text[">="]],condition:[window.XC_Text["<="],window.XC_Text[">="]]},"airquality"==a&&(o.push({id:n[i][0],value:"<="}),o.push({id:n[i][1],value:">="}))):"geniusA"==t||"geniusB"==t||"aeropac"==t||"mh10"==t||"axxentHSA"==t||"axxentHSA2"==t||"axxentDK"==t?(n={trigger:window.XC_Text.changesto,condition:window.XC_Text.is},o.push({id:n[i],value:"="})):"aeromatVT"==t||"aerovital"==t?(n={trigger:[window.XC_Text["<="],window.XC_Text[">="],window.XC_Text.changesto],condition:[window.XC_Text["<="],window.XC_Text[">="],window.XC_Text.is]},"indoorHum"==a||"outdoorHum"==a||"outdoorTemp"==a||"indoorTemp"==a||"airquality"==a?(o.push({id:n[i][0],value:"<="}),o.push({id:n[i][1],value:">="})):"state"!=a&&"automode"!=a&&"fanmode"!=a&&"warning"!=a||o.push({id:n[i][2],value:"="})):"aerotube"==t&&(n={trigger:[window.XC_Text["<="],window.XC_Text[">="],window.XC_Text.changesto],condition:[window.XC_Text["<="],window.XC_Text[">="],window.XC_Text.is]},"fanmode"==a||"automode"==a||"state"==a||"warning"==a?o.push({id:n[i][2],value:"="}):("fanpower"==a|"autoairflow"==a||"indoorTemp"==a||"indoorHum"==a)&&(o.push({id:n[i][0],value:"<="}),o.push({id:n[i][1],value:">="}))),o;},xnm.aio.siegenia.RulesManager.prototype.getDeviceChannels=function(e,t,i){var a=[];return"sensoair"==t?"trigger"!=i&&"condition"!=i||(a=["airquality"]):"geniusB"==t?"trigger"==i||"condition"==i?a=["mode","state"]:"action"==i&&(a=["state"]):"geniusA"==t?"action"==i&&(a=["state"]):"axxentDK"==t||"axxentHSA"==t||"axxentHSA2"==t?"trigger"==i?a=["state","warning"]:("condition"==i||"action"==i)&&(a=["state"]):"mh10"==t?("trigger"==i||"condition"==i||"action"==i)&&(a=["state"]):"aeropac"==t?"trigger"==i?a=["state","warning"]:("condition"==i||"action"==i)&&(a=["state"]):"aerotube"==t?"trigger"==i?a=["indoorHum","indoorTemp","autoairflow","fanpower","automode","fanmode","state","warning"]:"condition"==i?a=["indoorHum","indoorTemp","autoairflow","fanpower","automode","fanmode","state"]:"action"==i&&(a=["state"]):"aeromatVT"!=t&&"aerovital"!=t||("trigger"==i?(a=["automode","indoorHum","outdoorHum","outdoorTemp","indoorTemp","airquality","state","warning"],"aerovital"==t&&(a=["fanmode","automode","indoorHum","outdoorHum","outdoorTemp","indoorTemp","airquality","state","warning"])):"condition"==i?(a=["automode","indoorHum","outdoorHum","outdoorTemp","indoorTemp","airquality","state"],"aerovital"==t&&(a=["fanmode","automode","indoorHum","outdoorHum","outdoorTemp","indoorTemp","airquality","state"])):"action"==i&&(a=["state"])),a;},xnm.aio.siegenia.RulesManager.prototype.getCommands=function(e,t,i,a){var n=[];if("sensoair"==t)"trigger"!=i&&"condition"!=i||"airquality"!=a||n.push({id:"?",value:"?",hysteresis:!0,status:"airquality",type:"device.status",sys:"siegenia"});else if("geniusA"==t||"axxentDK"==t||"axxentHSA"==t)"action"==i?(n.push({id:window.XC_Text.open.toLowerCase(),value:"open",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.close.toLowerCase(),value:"close",action:"",sys:"siegenia",subtype:"command",type:"action"}),"axxentHSA"==t&&(n.push({id:window.XC_Text.lock.toLowerCase(),value:"lock",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.open_gap,value:"position1",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.open_to_position,value:"position2",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.activate_timer10,value:"startTimer",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.deactivate_timer10,value:"stopTimer",action:"",sys:"siegenia",subtype:"command",type:"action"})),"axxentDK"==t&&(n.push({id:window.XC_Text.automode_on.toLowerCase(),value:"automodeOn",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_off.toLowerCase(),value:"automodeOff",action:"",sys:"siegenia",subtype:"command",type:"action"}))):"condition"!=i&&"trigger"!=i||("axxentDK"!=t&&"axxentHSA"!=t&&"geniusA"!=t||"state"!=a?"axxentDK"==t&&"trigger"==i&&"warning"==a&&n.push({id:window.XC_Text.CLOSE_FAILED,value:"CLOSE_FAILED",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}):(n.push({id:window.XC_Text.opened.toLowerCase(),value:"open",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.closed.toLowerCase(),value:"closed",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),"axxentHSA"==t&&(n.push({id:window.XC_Text.stop.toLowerCase(),value:"stop",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.locked.toLowerCase(),value:"locked",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.gap_vent,value:"gap",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),"trigger"==i&&n.push({id:window.XC_Text.ENGINE_OVERHEATING,value:"ENGINE_OVERHEATING",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}))));else if("axxentHSA2"==t)"action"==i?(n.push({id:window.XC_Text.wing1open,value:"wing1open",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.wing2open,value:"wing2open",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.close_wing1,value:"wing1close",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.close_wing2,value:"wing2close",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.stop_wing1,value:"wing1stop",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.stop_wing2,value:"wing2stop",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.lock.toLowerCase(),value:"wing1lock",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.open_gap,value:"wing1position1",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.open_to_position,value:"wing1position2",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.activate_timer10,value:"startTimer",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.deactivate_timer10,value:"stopTimer",action:"",sys:"siegenia",subtype:"command",type:"action"})):"condition"!=i&&"trigger"!=i||("state"==a?(n.push({id:window.XC_Text.opened.toLowerCase(),value:"open",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.closed.toLowerCase(),value:"closed",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.locked.toLowerCase(),value:"locked",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.gap_vent,value:"gap",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"})):"warning"==a&&"trigger"==i&&n.push({id:window.XC_Text.ENGINE_OVERHEATING,value:"ENGINE_OVERHEATING",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}));else if("geniusB"==t)"action"==i?(n.push({id:window.XC_Text.open.toLowerCase(),value:"open",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.close.toLowerCase(),value:"close",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.in_day_mode,value:"daymode",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.in_night_mode,value:"nightmode",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"})):"condition"!=i&&"trigger"!=i||"state"!=a?"condition"==i&&"mode"==a?(n.push({id:window.XC_Text.in_day_mode,value:"day",hysteresis:!1,status:"mode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.in_night_mode,value:"night",hysteresis:!1,status:"mode",type:"device.status",sys:"siegenia"})):"trigger"==i&&"mode"==a&&(n.push({id:window.XC_Text.day_mode,value:"day",hysteresis:!1,status:"mode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.night_mode,value:"night",hysteresis:!1,status:"mode",type:"device.status",sys:"siegenia"})):(n.push({id:window.XC_Text.opened.toLowerCase(),value:"open",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.closed.toLowerCase(),value:"closed",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.locked.toLowerCase(),value:"locked",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}));else if("mh10"==t)"action"==i?(n.push({id:window.XC_Text.open.toLowerCase(),value:"open",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.close.toLowerCase(),value:"close",action:"",sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.stop.toLowerCase(),value:"stop",action:"",sys:"siegenia",subtype:"command",type:"action"})):"condition"==i&&"state"==a&&(n.push({id:window.XC_Text.opened.toLowerCase(),value:"open",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.closed.toLowerCase(),value:"close",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}));else if("aeropac"==t)"action"==i?(n.push({id:window.XC_Text.on.toLowerCase(),value:"on",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.off.toLowerCase(),value:"off",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"})):"trigger"!=i&&"condition"!=i||"state"!=a?"trigger"==i&&"warning"==a&&n.push({id:window.XC_Text.REPLACE_AIRFILTER,value:"REPLACE_AIRFILTER",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}));else if("aeromatVT"==t){if("action"==i){n.push({id:window.XC_Text.on.toLowerCase(),value:"on",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.off.toLowerCase(),value:"off",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_on,value:"automodeOn",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_off,value:"automodeOff",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});for(var o=0;o<21;o++){var s=10*Math.round(o/21*100)/10;n.push({id:o+1+" m3/h ",value:"setTo"+s,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});}}else"trigger"!=i&&"condition"!=i||"state"!=a?"trigger"!=i&&"condition"!=i||"automode"!=a?"trigger"!=i&&"condition"!=i||"indoorHum"!=a?"trigger"!=i&&"condition"!=i||"outdoorHum"!=a?"trigger"!=i&&"condition"!=i||"indoorTemp"!=a?"trigger"!=i&&"condition"!=i||"outdoorTemp"!=a?"trigger"!=i&&"condition"!=i||"airquality"!=a?"trigger"==i&&"warning"==a&&(n.push({id:window.XC_Text.REPLACE_AIRFILTER,value:"REPLACE_AIRFILTER",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.FROST_PROTECTION,value:"FROST_PROTECTION",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"})):n.push({id:"?",value:"?",hysteresis:!0,status:"airquality",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"outdoorTemp",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"indoorTemp",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"outdoorHum",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"indoorHum",type:"device.status",sys:"siegenia"}):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"})):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}));}else if("aerotube"==t){if("action"==i){for(n.push({id:window.XC_Text.on.toLowerCase(),value:"on",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.off.toLowerCase(),value:"off",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_on,value:"automodeOn",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_off,value:"automodeOff",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_in,value:"fanmodeIn",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_out,value:"fanmodeOut",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_inout,value:"fanmodeInOut",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),o=7;o<45;o++)s=10*Math.round(o/45*100)/10,n.push({id:window.XC_Text.fan_power+" "+(o+1)+" m3/h",value:"setTo"+s,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});for(o=7;o<45;o++)s=10*Math.round(o/45*100)/10,n.push({id:window.XC_Text.auto_fan_power+" "+(o+1)+" m3/h",value:"setAutoTo"+s,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});}else"trigger"==i&&"warning"==a?n.push({id:window.XC_Text.REPLACE_AIRFILTER,value:"REPLACE_AIRFILTER",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}):"trigger"!=i&&"condition"!=i||"fanmode"!=a?"trigger"!=i&&"condition"!=i||"automode"!=a?"trigger"!=i&&"condition"!=i||"fanpower"!=a?"trigger"!=i&&"condition"!=i||"autoairflow"!=a?"trigger"!=i&&"condition"!=i||"indoorTemp"!=a?"trigger"!=i&&"condition"!=i||"indoorHum"!=a||n.push({id:"?",value:"?",hysteresis:!0,status:"indoorHum",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"indoorTemp",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"autoairflow",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"fanpower",type:"device.status",sys:"siegenia"}):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"})):(n.push({id:window.XC_Text.fanmode_in,value:"in",hysteresis:!1,status:"fanmode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.fanmode_out,value:"out",hysteresis:!1,status:"fanmode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.fanmode_inout,value:"in_out",hysteresis:!1,status:"fanmode",type:"device.status",sys:"siegenia"}));}else if("aerovital"==t)if("action"==i){for(n.push({id:window.XC_Text.on.toLowerCase(),value:"on",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.off.toLowerCase(),value:"off",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_on,value:"automodeOn",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.automode_off,value:"automodeOff",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_in.toLowerCase(),value:"fanmodeIn",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_out,value:"fanmodeOut",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_inout,value:"fanmodeInOut",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),n.push({id:window.XC_Text.fanmode_inout_wrg,value:"fanmodeInOutWRG",action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"}),o=0;o<60;o++)s=10*Math.round(o/60*100)/10,n.push({id:window.XC_Text.fan_power+" "+(o+1)+" m3/h",value:"setTo"+s,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});for(o=0;o<60;o++)s=10*Math.round(o/60*100)/10,n.push({id:window.XC_Text.auto_fan_power+" "+(o+1)+" m3/h",value:"setAutoTo"+s,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});for(o=0;o<100;o+=5)n.push({id:window.XC_Text.auto_fan_power+" Sensor "+(o+1)+" m3/h",value:"setSensorTo"+o,action:window.XC_Text.action_switch,sys:"siegenia",subtype:"command",type:"action"});}else"trigger"!=i&&"condition"!=i||"state"!=a?"trigger"!=i&&"condition"!=i||"automode"!=a?"trigger"!=i&&"condition"!=i||"indoorHum"!=a?"trigger"!=i&&"condition"!=i||"outdoorHum"!=a?"trigger"!=i&&"condition"!=i||"indoorTemp"!=a?"trigger"!=i&&"condition"!=i||"outdoorTemp"!=a?"trigger"!=i&&"condition"!=i||"airquality"!=a?"trigger"==i&&"warning"==a&&(n.push({id:window.XC_Text.REPLACE_AIRFILTER,value:"REPLACE_AIRFILTER",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.FROST_PROTECTION,value:"FROST_PROTECTION",hysteresis:!1,status:"warning",type:"device.status",sys:"siegenia"})):n.push({id:"?",value:"?",hysteresis:!0,status:"airquality",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"outdoorTemp",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"indoorTemp",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"outdoorHum",type:"device.status",sys:"siegenia"}):n.push({id:"?",value:"?",hysteresis:!0,status:"indoorHum",type:"device.status",sys:"siegenia"}):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"automode",type:"device.status",sys:"siegenia"})):(n.push({id:window.XC_Text.switchedon.toLowerCase(),value:"on",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}),n.push({id:window.XC_Text.switchedoff.toLowerCase(),value:"off",hysteresis:!1,status:"state",type:"device.status",sys:"siegenia"}));return n;},xnm.aio.siegenia.DM=function(){var e=function e(_e4,t){this.code=_e4,this.message=t,this.stack=new Error().stack;};return(e.prototype=new Error()).name="SiegeniaDMError",e.prototype.code=0,e.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6},{SYS:"siegenia",MAP:{geniusA:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}}]},aOpener:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"impulse on",ref:{value:"impulseOn"}},{type:"enum",name:"impulse off",ref:{value:"impulseOff"}},{type:"int",name:"set impulse duration",ref:{value:"setImpulse",ext:"%d",extMeta:"1-86400",unit:"s"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}},{type:"enum",name:"impulse",ref:{value:"impulse",options:["enabled","disabled"]}},{type:"int",name:"impulse duration",ref:{value:"impulseduration",ext:"%d",extMeta:"1-86400",unit:"s"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}]},axxentDK:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"open to turn",ref:{value:"open_to_turn"}},{type:"enum",name:"silent on",ref:{value:"silentOn"}},{type:"enum",name:"silent off",ref:{value:"silentOff"}},{type:"enum",name:"activate timer",ref:{value:"startTimer"}},{type:"int",name:"set timer",ref:{value:"setTimer",ext:"%d",extMeta:"1-60",unit:"min"}},{type:"enum",name:"deactivate timer",ref:{value:"stopTimer"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","moving","turning_position"]}},{type:"enum",name:"silent state",ref:{value:"silent_state",options:["on","off"]}},{type:"enum",name:"timer enabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}},{type:"int",name:"timer duration",ref:{value:"durationM",ext:"%d",unit:"min"}},{type:"int",name:"timer remain",ref:{value:"remainingTimeM",ext:"%d",unit:"min"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","moving","turning_position"]}},{type:"enum",name:"warning",ref:{value:"warning",options:["CLOSE_FAILED"]}}]},axxentHSA:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"lock",ref:{value:"lock"}},{type:"enum",name:"open to stopover",ref:{value:"position1"}},{type:"enum",name:"open gap",ref:{value:"position2"}},{type:"enum",name:"activate timer",ref:{value:"startTimer"}},{type:"int",name:"set timer",ref:{value:"setTimer",ext:"%d",extMeta:"1-60",unit:"min"}},{type:"enum",name:"deactivate timer",ref:{value:"stopTimer"}},{type:"int",name:"set stopover",ref:{value:"setStopover",ext:"%d",unit:"cm"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"timer enabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}},{type:"int",name:"timer duration",ref:{value:"durationM",ext:"%d",unit:"min"}},{type:"int",name:"timer remain",ref:{value:"remainingTimeM",ext:"%d",unit:"min"}},{type:"int",name:"stopover",ref:{value:"stopover",ext:"%d",unit:"cm"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"warning",ref:{value:"warning",options:["ENGINE_OVERHEATING"]}}]},axxentHSA2:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"lock",ref:{value:"lock"}},{type:"enum",name:"open to stopover",ref:{value:"position1"}},{type:"enum",name:"open gap",ref:{value:"position2"}},{type:"enum",name:"sash 1 stop",ref:{value:"wing1stop"}},{type:"enum",name:"sash 1 open",ref:{value:"wing1open"}},{type:"enum",name:"sash 1 close",ref:{value:"wing1close"}},{type:"enum",name:"sash 1 open to stopover",ref:{value:"wing1position1"}},{type:"enum",name:"sash 1 open gap",ref:{value:"wing1position2"}},{type:"enum",name:"sash 2 stop",ref:{value:"wing2stop"}},{type:"enum",name:"sash 2 open",ref:{value:"wing2open"}},{type:"enum",name:"sash 2 close",ref:{value:"wing2close"}},{type:"enum",name:"activate timer",ref:{value:"startTimer"}},{type:"int",name:"set timer",ref:{value:"setTimer",ext:"%d",extMeta:"1-60",unit:"min"}},{type:"enum",name:"deactivate timer",ref:{value:"stopTimer"}},{type:"int",name:"set stopover",ref:{value:"setStopover",ext:"%d",unit:"cm"}}],status:[{type:"enum",name:"1. sash state",ref:{value:"wing1state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"2. sash state",ref:{value:"wing2state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"timer enabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}},{type:"int",name:"timer duration",ref:{value:"durationM",ext:"%d",unit:"min"}},{type:"int",name:"timer remain",ref:{value:"remainingTimeM",ext:"%d",unit:"min"}},{type:"int",name:"stopover",ref:{value:"stopover",ext:"%d",unit:"cm"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"1. sash state",ref:{value:"wing1state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"2. sash state",ref:{value:"wing2state",options:["open","closed","locked","gap","stopover","stop","moving"]}},{type:"enum",name:"warning",ref:{value:"warning",options:["ENGINE_OVERHEATING"]}}]},geniusB:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"day",ref:{value:"daymode"}},{type:"enum",name:"night",ref:{value:"nightmode"}},{type:"enum",name:"impulse on",ref:{value:"impulseOn"}},{type:"enum",name:"impulse off",ref:{value:"impulseOff"}},{type:"int",name:"set impulse duration",ref:{value:"setImpulse",ext:"%d",extMeta:"1-86400",unit:"s"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked"]}},{type:"enum",name:"mode",ref:{value:"mode",options:["day","night"]}},{type:"enum",name:"impulse",ref:{value:"impulse",options:["enabled","disabled"]}},{type:"int",name:"impulse duration",ref:{value:"impulseduration",ext:"%d",extMeta:"1-86400",unit:"s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked"]}},{type:"enum",name:"mode",ref:{value:"mode",options:["day","night"]}}]},mh10:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}]},aeropac:{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"activate timer",ref:{value:"startTimer"}},{type:"int",name:"set timer",ref:{value:"setTimer",ext:"%d",extMeta:"1-18",unit:"hour"}},{type:"enum",name:"deactivate timer",ref:{value:"stopTimer"}},{type:"enum",name:"activate daily power on",ref:{value:"startDailyPowerOn"}},{type:"enum",name:"deactivate daily power on",ref:{value:"stopDailyPowerOn"}},{type:"string",name:"set daily power on time",ref:{value:"setDailyPowerOn",ext:"%s"}},{type:"int",name:"set fan level",ref:{value:"setTo",ext:"%d",extMeta:"1-7"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"int",name:"fan level",ref:{value:"fanlevel"}},{type:"int",name:"timer duration",ref:{value:"durationH",ext:"%d",unit:"hour"}},{type:"int",name:"timer remain",ref:{value:"remainingTimeM",ext:"%d",unit:"min"}},{type:"string",name:"time remain text",ref:{value:"remainingTime"}},{type:"enum",name:"timer enabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}},{type:"string",name:"daily power on time",ref:{value:"dailyPowerOnTime"}},{type:"enum",name:"daily power on enabled",ref:{value:"dailyPowerOnEnabled",options:["enabled","disabled"]}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"warning",ref:{value:"warning",options:["REPLACE_AIRFILTER"]}}]},aeromatVT:{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"automode on",ref:{value:"automodeOn"}},{type:"enum",name:"automode off",ref:{value:"automodeOff"}},{type:"int",name:"set fan power",ref:{value:"setTo",ext:"%d",extMeta:"0-21",unit:"m3/h"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"float",name:"fan power",ref:{value:"fanpower"}},{type:"int",name:"air quality",ref:{value:"airquality"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"outdoor temperature",ref:{value:"outdoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"float",name:"outdoor humidity",ref:{value:"outdoorHum"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"int",name:"air quality",ref:{value:"airquality"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"outdoor temperature",ref:{value:"outdoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"float",name:"outdoor humidity",ref:{value:"outdoorHum"}},{type:"enum",name:"warning",ref:{value:"warning",options:["REPLACE_AIRFILTER","FROST_PROTECTION"]}}]},aerotube:{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"automode on",ref:{value:"automodeOn"}},{type:"enum",name:"automode off",ref:{value:"automodeOff"}},{type:"enum",name:"fan mode in",ref:{value:"fanmodeIn"}},{type:"enum",name:"fan mode out",ref:{value:"fanmodeOut"}},{type:"enum",name:"fan mode in-out",ref:{value:"fanmodeInOut"}},{type:"int",name:"set fan power",ref:{value:"setTo",ext:"%d",extMeta:"7-45",unit:"m3/h"}},{type:"int",name:"auto max fan power",ref:{value:"setAutoTo",ext:"%d",extMeta:"7-45",unit:"m3/h"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"fan mode",ref:{value:"fanmode",options:["in","out","in_out"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"float",name:"fan power",ref:{value:"fanpower"}},{type:"float",name:"auto max fan power",ref:{value:"autoairflow"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"fan mode",ref:{value:"fanmode",options:["in","out","in_out"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"float",name:"fan power",ref:{value:"fanpower"}},{type:"float",name:"auto max fan power",ref:{value:"autoairflow"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"enum",name:"warning",ref:{value:"warning",options:["REPLACE_AIRFILTER"]}}]},aerovital:{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"automode on",ref:{value:"automodeOn"}},{type:"enum",name:"automode off",ref:{value:"automodeOff"}},{type:"enum",name:"fanmode in",ref:{value:"fanmodeIn"}},{type:"enum",name:"fanmode out",ref:{value:"fanmodeOut"}},{type:"enum",name:"fanmode in/out",ref:{value:"fanmodeInOut"}},{type:"enum",name:"fanmode in/out (wrg)",ref:{value:"fanmodeInOutWRG"}},{type:"int",name:"set fan power",ref:{value:"setTo",ext:"%d",extMeta:"0-60",unit:"m3/h"}},{type:"int",name:"auto max fan power",ref:{value:"setAutoTo",ext:"%d",extMeta:"9-60",unit:"m3/h"}},{type:"int",name:"auto sensor sensitivity",ref:{value:"setSensorTo",ext:"%d",extMeta:"0-100"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"float",name:"fan power",ref:{value:"fanpower"}},{type:"enum",name:"fan mode",ref:{value:"fanmode",options:["in","out","in_out","in_out_wrg","auto"]}},{type:"float",name:"auto max fan power",ref:{value:"autoairflow"}},{type:"int",name:"auto sensor sensitivity",ref:{value:"autosensitivity"}},{type:"int",name:"air quality",ref:{value:"airquality"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"outdoor temperature",ref:{value:"outdoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"float",name:"outdoor humidity",ref:{value:"outdoorHum"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}},{type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}},{type:"int",name:"air quality",ref:{value:"airquality"}},{type:"float",name:"indoor temperature",ref:{value:"indoorTemp"}},{type:"float",name:"outdoor temperature",ref:{value:"outdoorTemp"}},{type:"float",name:"indoor humidity",ref:{value:"indoorHum"}},{type:"float",name:"outdoor humidity",ref:{value:"outdoorHum"}},{type:"enum",name:"warning",ref:{value:"warning",options:["REPLACE_AIRFILTER","FROST_PROTECTION"]}}]},sensoair:{command:[{type:"enum",name:"leds on",ref:{value:"ledsOn"}},{type:"enum",name:"leds off",ref:{value:"ledsOff"}}],status:[{type:"enum",name:"leds",ref:{value:"leds",options:["on","off"]}},{type:"int",name:"airquality",ref:{value:"airquality",extMeta:"1-7"}},{type:"string",name:"warnings",ref:{value:"warnings",ext:"%s"}}],ipevt:[{type:"int",name:"airquality",ref:{value:"airquality"}}]}},registModule:function registModule(e){e.register(this.SYS,"SIEGENIA Comfort");},getIPDeviceType:function getIPDeviceType(){return[{sys:this.SYS,name:"AEROPAC",data:"aeropac",model:1,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"AEROMAT VT",data:"aeromatVT",model:2,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"DRIVE axxent DK",data:"axxentDK",model:3,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"DRIVE axxent MH",data:"axxentDK",model:3,variant:1,subvariant:0,port:443},{sys:this.SYS,name:"SENSOAIR",data:"sensoair",model:4,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"AEROVITAL Ambience",data:"aerovital",model:5,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"MHS400 Schema A",data:"axxentHSA",model:6,variant:1,subvariant:0,port:443},{sys:this.SYS,name:"DRIVE axxent HSA Schema A",data:"axxentHSA",model:6,variant:1,subvariant:1,port:443},{sys:this.SYS,name:"MHS400 Schema C",data:"geniusB",model:6,variant:2,subvariant:0,port:443},{sys:this.SYS,name:"DRIVE axxent HSA Schema C",data:"axxentHSA2",model:6,variant:2,subvariant:1,port:443},{sys:this.SYS,name:"MSA",data:"geniusB",model:6,variant:3,subvariant:0,port:443},{sys:this.SYS,name:"MSA HiFinity",data:"geniusB",model:6,variant:3,subvariant:1,port:443},{sys:this.SYS,name:"MSA Sapa",data:"geniusB",model:6,variant:3,subvariant:2,port:443},{sys:this.SYS,name:"MSA Keller",data:"geniusB",model:6,variant:3,subvariant:3,port:443},{sys:this.SYS,name:"AEROTUBE",data:"aerotube",model:8,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"Universal",data:"axxentHSA",model:10,variant:0,subvariant:0,port:443},{sys:this.SYS,name:"A-opener",data:"aOpener",model:10,variant:1,subvariant:0,port:443},{sys:this.SYS,name:"GENIUS A",data:"geniusA",model:10,variant:2,subvariant:0,port:443},{sys:this.SYS,name:"GENIUS B",data:"geniusB",model:10,variant:3,subvariant:0,port:443},{sys:this.SYS,name:"MH10",data:"mh10",model:10,variant:4,subvariant:0,port:443}];},createDevice:function createDevice(t,i,a){var n=e,o=e.ERROR_CODE;t?t.ip?t.data?a(null,t):a(new n(o.INVALID,"data is invalid")):a(new n(o.INVALID,"ip is invalid")):a(new n(o.INVALID,"info is invalid"));},updateDevice:function updateDevice(t,i,a){var n=e,o=e.ERROR_CODE;t?t.ip?t.data?a(null,t):a(new n(o.INVALID,"data is invalid")):a(new n(o.INVALID,"ip is invalid")):a(new n(o.INVALID,"info is invalid"));},deleteDevice:function deleteDevice(e,t,i){i();},applyUIFilter:function applyUIFilter(e,t,i){var a=function a(e,t){if("*"==e)return!0;for(var i=!1,a=0;a<e.length;a++)if(e[a]==t){i=!0;break;}return i;},n=function n(e,t){var n=[],o=null,s=xnm.aio.siegenia.DM.getCommandStatusMap(e,i);return s&&(o=function(e,t,i){var n=[];switch(i.catagory){case"command":e.command&&e.command.forEach(function(e){if(a(i.elems,e.type)){var t=JSON.parse(JSON.stringify(e));n.push(t);}});break;case"status":e.status&&e.status.forEach(function(e){if(a(i.elems,e.type)){var t=JSON.parse(JSON.stringify(e));n.push(t);}});}return n;}(s,0,t),n=n.concat(o)),n;};if(!e.sys)return null;var o=JSON.parse(JSON.stringify(e)),s=null;switch(t.catagory){case"command":s=n(e,t),o.command=s;break;case"status":s=n(e,t),o.status=s;break;default:return null;}return s&&0!=s.length?o:null;},applyIPEventFilter:function applyIPEventFilter(e,t){var i=xnm.aio.siegenia.DM.getCommandStatusMap(e);if(!i)return null;var a=JSON.parse(JSON.stringify(e));return a.ipevt=i.ipevt,a;},getCommandStatusMap:function getCommandStatusMap(e){return e&&e.data?this.MAP[e.data]:null;}};}(),xnm.aio.siegenia.Handler=function(){var e=function e(){this._logger=require("x.logger.js").getLogger("xnm.aio.siegenia.Handler");var e=this;this._discoverCallbacks=[],this._mdnsCallback=function(t,i){e._findSiegeniaDevice(t,i);},this._discoverTO=null,this._discoverRunning=!1;};return e.prototype.SessionManager=xnm.aio.siegenia._SessionManager,e.prototype.getStateValues=function(e,t){return"genius"==e.type?new xnm.aio.siegenia.Genius().getStateValues(t):"aeropac"==e.type?new xnm.aio.siegenia.AEROPAC().getStateValues(t):{};},e.prototype.getDeviceStatesList=function(e){var t=[];return"geniusA"==e.data?t.push({type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}}):"geniusB"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked"]}}),t.push({type:"enum",name:"mode",ref:{value:"mode",options:["day","night"]}})):"axxentDK"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["open","closed","moving","turning_position"]}}),t.push({type:"enum",name:"silent state",ref:{value:"silent_state",options:["on","off"]}}),t.push({type:"enum",name:"timerEnabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}}),t.push({type:"string",name:"remainingTime",ref:{value:"remainingTime"}})):"axxentHSA"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["open","closed","locked","gap","stopover","stop","moving"]}}),t.push({type:"enum",name:"timerEnabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}}),t.push({type:"string",name:"remainingTime",ref:{value:"remainingTime"}})):"axxentHSA2"==e.data?(t.push({type:"enum",name:"1. wing state",ref:{value:"wing1state",options:["open","closed","locked","gap","stopover","stop","moving"]}}),t.push({type:"enum",name:"2. wing state",ref:{value:"wing2state",options:["open","closed","locked","gap","stopover","stop","moving"]}}),t.push({type:"enum",name:"timerEnabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}}),t.push({type:"string",name:"remainingTime",ref:{value:"remainingTime"}})):"mh10"==e.data||("aeropac"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["on","off"]}}),t.push({type:"int",name:"fanlevel",ref:{value:"fanlevel"}}),t.push({type:"string",name:"timeRemaining",ref:{value:"timeRemaining"}}),t.push({type:"enum",name:"timerEnabled",ref:{value:"timerEnabled",options:["enabled","disabled"]}}),t.push({type:"string",name:"dailyPowerOnTime",ref:{value:"dailyPowerOnTime"}}),t.push({type:"enum",name:"dailyPowerOnEnabled",ref:{value:"dailyPowerOnEnabled",options:["enabled","disabled"]}})):"aeromatVT"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["on","off"]}}),t.push({type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}}),t.push({type:"float",name:"fanpower",ref:{value:"fanpower"}}),t.push({type:"int",name:"airquality",ref:{value:"airquality"}}),t.push({type:"float",name:"indoorTemp",ref:{value:"indoorTemp"}}),t.push({type:"float",name:"outdoorTemp",ref:{value:"outdoorTemp"}}),t.push({type:"float",name:"indoorHum",ref:{value:"indoorHum"}}),t.push({type:"float",name:"outdoorHum",ref:{value:"outdoorHum"}})):"aerotube"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["on","off"]}}),t.push({type:"enum",name:"fanmode",ref:{value:"fanmode",options:["in","out","in_out"]}}),t.push({type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}}),t.push({type:"float",name:"fanpower",ref:{value:"fanpower"}}),t.push({type:"float",name:"autoairflow",ref:{value:"autoairflow"}}),t.push({type:"float",name:"indoorTemp",ref:{value:"indoorTemp"}}),t.push({type:"float",name:"indoorHum",ref:{value:"indoorHum"}})):"aerovital"==e.data?(t.push({type:"enum",name:"state",ref:{value:"state",options:["on","off"]}}),t.push({type:"enum",name:"fanmode",ref:{value:"fanmode",options:["in","out","in_out","in_out_wrg"]}}),t.push({type:"enum",name:"automode",ref:{value:"automode",options:["on","off"]}}),t.push({type:"float",name:"fanpower",ref:{value:"fanpower"}}),t.push({type:"float",name:"autoairflow",ref:{value:"autoairflow"}}),t.push({type:"int",name:"autosensitivity",ref:{value:"autosensitivity"}}),t.push({type:"float",name:"indoorTemp",ref:{value:"indoorTemp"}}),t.push({type:"float",name:"outdoorTemp",ref:{value:"outdoorTemp"}}),t.push({type:"float",name:"indoorHum",ref:{value:"indoorHum"}}),t.push({type:"float",name:"outdoorHum",ref:{value:"outdoorHum"}}),t.push({type:"int",name:"airquality",ref:{value:"airquality"}})):"sensoair"==e.data&&(t.push({type:"enum",name:"leds",ref:{value:"leds",options:["on","off"]}}),t.push({type:"int",name:"airquality",ref:{value:"airquality"}}))),t.push({type:"array",name:"warnings",ref:{value:"warnings"}}),t;},e.prototype.getDeviceCommandList=function(e,t){var i=[];if("geniusA"==e.data||"axxentDK"==e.data||"axxentHSA"==e.data||"aOpener"==e.data||"axxentHSA2"==e.data)i.push({id:window.XC_Text.open,cmd:"open"}),i.push({id:window.XC_Text.close,cmd:"close"}),"axxentHSA"==e.data&&(i.push({id:window.XC_Text.stop,cmd:"stop"}),i.push({id:window.XC_Text.lock,cmd:"lock"}),i.push({id:window.XC_Text.open_gap,cmd:"position1"}),i.push({id:window.XC_Text.open_to_position,cmd:"position2"}),i.push({id:window.XC_Text.activate_timer10,cmd:"setTimer10"}),i.push({id:window.XC_Text.deactivate_timer10,cmd:"stopTimer"}),i.push({id:window.XC_Text.activate_timer,cmd:"startTimer"}),i.push({id:window.XC_Text.set_timer,cmd:"setTimer"}),i.push({id:window.XC_Text.deactivate_timer,cmd:"stopTimer"}),i.push({id:window.XC_Text.set_stopover,cmd:"setStopover"})),"axxentHSA2"==e.data&&(i.push({id:window.XC_Text.stop,cmd:"stop"}),i.push({id:window.XC_Text.open,cmd:"open"}),i.push({id:window.XC_Text.lock,cmd:"lock"}),i.push({id:window.XC_Text.open_gap,cmd:"position1"}),i.push({id:window.XC_Text.open_to_position,cmd:"position2"}),i.push({id:window.XC_Text.stop,cmd:"wing1stop"}),i.push({id:window.XC_Text.open,cmd:"wing1open"}),i.push({id:window.XC_Text.close,cmd:"wing1close"}),i.push({id:window.XC_Text.open_gap,cmd:"wing1position1"}),i.push({id:window.XC_Text.open_to_position,cmd:"wing1position2"}),i.push({id:window.XC_Text.stop,cmd:"wing2stop"}),i.push({id:window.XC_Text.open,cmd:"wing2open"}),i.push({id:window.XC_Text.close,cmd:"wing2close"}),i.push({id:window.XC_Text.activate_timer10,cmd:"setTimer10"}),i.push({id:window.XC_Text.deactivate_timer10,cmd:"stopTimer"}),i.push({id:window.XC_Text.activate_timer,cmd:"startTimer"}),i.push({id:window.XC_Text.set_timer,cmd:"setTimer"}),i.push({id:window.XC_Text.deactivate_timer,cmd:"stopTimer"})),"axxentDK"==e.data&&(i.push({id:window.XC_Text.open_to_turn,cmd:"open_to_turn"}),i.push({id:window.XC_Text.silent_on,cmd:"silentOn"}),i.push({id:window.XC_Text.silent_off,cmd:"silentOff"}),i.push({id:window.XC_Text.automode_on,cmd:"automodeOn"}),i.push({id:window.XC_Text.automode_off,cmd:"automodeOff"}),i.push({id:window.XC_Text.activate_timer,cmd:"startTimer"}),i.push({id:window.XC_Text.set_timer,cmd:"setTimer"}),i.push({id:window.XC_Text.deactivate_timer,cmd:"stopTimer"}));else if("geniusB"==e.data)i.push({id:window.XC_Text.open,cmd:"open"}),i.push({id:window.XC_Text.close,cmd:"close"}),i.push({id:window.XC_Text.day,cmd:"daymode"}),i.push({id:window.XC_Text.night,cmd:"nightmode"});else if("mh10"==e.data)i.push({id:window.XC_Text.open,cmd:"open"}),i.push({id:window.XC_Text.close,cmd:"close"}),i.push({id:window.XC_Text.stop,cmd:"stop"});else if("aeropac"==e.data){i.push({id:window.XC_Text.on,cmd:"on"}),i.push({id:window.XC_Text.off,cmd:"off"}),i.push({id:window.XC_Text.activate_timer10,cmd:"startTimer"}),i.push({id:window.XC_Text.deactivate_timer10,cmd:"stopTimer"}),i.push({id:window.XC_Text.set_timer,cmd:"setTimer"}),i.push({id:window.XC_Text.activate_daily,cmd:"startDailyPowerOn"}),i.push({id:window.XC_Text.deactivate_daily,cmd:"stopDailyPowerOn"}),i.push({id:window.XC_Text.set_daily,cmd:"setDailyPowerOn"});for(var a=1;a<=18;a++)i.push({id:window.XC_Text.activate_timer10+" "+a,cmd:"setTimer"+a});for(a=1;a<=7;a++)i.push({id:window.XC_Text.fan_power+" "+a,cmd:"setTo"+a});}else if("aeromatVT"==e.data)for(i.push({id:window.XC_Text.on,cmd:"on"}),i.push({id:window.XC_Text.off,cmd:"off"}),i.push({id:window.XC_Text.automode_on,cmd:"automodeOn"}),i.push({id:window.XC_Text.automode_off,cmd:"automodeOff"}),a=0;a<21;a++){var n=10*Math.round(a/21*100)/10;i.push({id:window.XC_Text.fan_power+" "+(a+1)+" m3/h",cmd:"setTo"+n});}else if("aerotube"==e.data){for(i.push({id:window.XC_Text.on,cmd:"on"}),i.push({id:window.XC_Text.off,cmd:"off"}),i.push({id:window.XC_Text.automode_on,cmd:"automodeOn"}),i.push({id:window.XC_Text.automode_off,cmd:"automodeOff"}),i.push({id:window.XC_Text.fanmode_in,cmd:"fanmodeIn"}),i.push({id:window.XC_Text.fanmode_out,cmd:"fanmodeOut"}),i.push({id:window.XC_Text.fanmode_inout,cmd:"fanmodeInOut"}),a=7;a<45;a++)n=10*Math.round(a/45*100)/10,i.push({id:window.XC_Text.fan_power+" "+(a+1)+" m3/h",cmd:"setTo"+n});for(a=7;a<45;a++)n=10*Math.round(a/45*100)/10,i.push({id:window.XC_Text.auto_fan_power+" "+(a+1)+" m3/h",cmd:"setAutoTo"+n});}else if("aerovital"==e.data){for(i.push({id:window.XC_Text.on,cmd:"on"}),i.push({id:window.XC_Text.off,cmd:"off"}),i.push({id:window.XC_Text.automode_on,cmd:"automodeOn"}),i.push({id:window.XC_Text.automode_off,cmd:"automodeOff"}),i.push({id:window.XC_Text.fanmode_in,cmd:"fanmodeIn"}),i.push({id:window.XC_Text.fanmode_out,cmd:"fanmodeOut"}),i.push({id:window.XC_Text.fanmode_inout,cmd:"fanmodeInOut"}),i.push({id:window.XC_Text.fanmode_inout_wrg,cmd:"fanmodeInOutWRG"}),a=0;a<60;a++)n=10*Math.round(a/60*100)/10,i.push({id:window.XC_Text.fan_power+" "+(a+1)+" m3/h",cmd:"setTo"+n});for(a=0;a<60;a++)n=10*Math.round(a/60*100)/10,i.push({id:window.XC_Text.auto_fan_power+" "+(a+1)+" m3/h",cmd:"setAutoTo"+n});for(a=0;a<100;a+=5)i.push({id:window.XC_Text.auto_fan_power+" "+(a+1)+" m3/h",cmd:"setSensorTo"+a});}else"sensoair"==e.data&&(i.push({id:window.XC_Text.ledsOn,cmd:"ledsOn"}),i.push({id:window.XC_Text.ledsOff,cmd:"ledsOff"}));return i;},e.prototype.getDevice=function(e){return"geniusA"==e.data?new this.Genius(e.address,"user",e.pwd,"A"):"geniusB"==e.data?new this.Genius(e.address,"user",e.pwd,"B"):"mh10"==e.data?new this.Genius(e.address,"user",e.pwd,"mh10"):"axxentDK"==e.data?new this.Genius(e.address,"user",e.pwd,"axxentDK"):"axxentHSA"==e.data?new this.Genius(e.address,"user",e.pwd,"axxentHSA"):"axxentHSA2"==e.data?new this.Genius(e.address,"user",e.pwd,"axxentHSA2"):"aOpener"==e.data?new this.Genius(e.address,"user",e.pwd,"aOpener"):"aeropac"==e.data?new this.AEROPAC(e.address,"user",e.pwd,"aeropac"):"aeromatVT"==e.data?new this.AEROPAC(e.address,"user",e.pwd,"aeromatVT"):"aerotube"==e.data?new this.AEROPAC(e.address,"user",e.pwd,"aerotube"):"aerovital"==e.data?new this.AEROPAC(e.address,"user",e.pwd,"aerovital"):"sensoair"==e.data?new this.AEROPAC(e.address,"user",e.pwd,"sensoair"):null;},e.prototype.Genius=xnm.aio.siegenia.Genius,e.prototype.AEROPAC=xnm.aio.siegenia.AEROPAC,e.prototype.RulesManager=xnm.aio.siegenia.RulesManager,e.prototype.discoveryStart=function(e){e&&-1==this._discoverCallbacks.indexOf(e)&&this._discoverCallbacks.push(e),require("x.mdns.js").discoverService("_siegenia._tcp.local",this._mdnsCallback);},e.prototype.discoveryStop=function(e){if(e){var t=this._discoverCallbacks.indexOf(e);-1!=t&&(XC.debugf("stop siegenia discovery with the correct callback"),this._discoverCallbacks.splice(t,1));}require("x.mdns.js").stopDiscover("_siegenia._tcp.local",this._mdnsCallback);},e.prototype._findSiegeniaDevice=function(e,t){var i;if(e)for(u=0;u<this._discoverCallbacks.length;u++)(m=this._discoverCallbacks[u])&&m(e,i);else if(t){this._logger.log("trace","receive mdns response:"+JSON.stringify(t));var a=null,n=null;if(t.ip&&t.ip[0]&&t.domain&&t.info){1==t.info.model?a="aeropac":2==t.info.model?a="aeromatVT":3==t.info.model?a="axxentDK":4==t.info.model?a="sensoair":5==t.info.model?a="aerovital":6==t.info.model?(1==t.info.variant&&0==t.info.subvariant?(a="axxentHSA",n="MHS400 Schema A"):1==t.info.variant&&1==t.info.subvariant?(a="axxentHSA",n="DRIVE axxent HSA Schema A"):2==t.info.variant&&1==t.info.subvariant&&(a="axxentHSA2",n="DRIVE axxent HSA Schema C"),a||(a="geniusB")):8==t.info.model?a="aerotube":10==t.info.model&&(1==t.info.variant?(a="aOpener",n="A-opener"):2==t.info.variant?(a="geniusA",n="GENIUS A"):3==t.info.variant?(a="geniusB",n="GENIUS B"):4==t.info.variant&&(a="mh10",n="MH10"),a||(a="axxentHSA"));var o=t.domain.split(".")[0],s=t.ip[0],r=t.info.serial;i={sys:"siegenia",ip:s,port:443,username:"user",password:null,data:a,model:t.info.model,variant:t.info.variant,subvariant:t.info.subvariant,serial:r,address:s,name:o,subtype:n};}if(i){this._logger.log("trace","find siegenia device:"+JSON.stringify(i));for(var u=0;u<this._discoverCallbacks.length;u++){var m=this._discoverCallbacks[u];m&&m(e,i);}}}},e.prototype.devicemanager=xnm.aio.siegenia.DM,e.prototype.registModule=function(e){e.register(this.devicemanager.SYS,"siegenia");},e.prototype.resolveDevice=function(e){if(!e||!e.ip||!e.data)return null;var t,i,a=null;switch(e.data){case"geniusA":case"geniusB":case"mh10":case"axxentDK":case"axxentHSA":case"axxentHSA2":case"aOpener":t=this.Genius,i=e.data,"geniusA"==e.data?i="A":"geniusB"==e.data&&(i="B");break;case"aeropac":case"aeromatVT":case"aerotube":case"aerovital":case"sensoair":t=this.AEROPAC,i=e.data;}return t&&i&&(a=new t(e.ip,e.username,e.password,i,e.port)),a&&(a._data=e.data,a._type=e.type,a._variant=e.variant,a._subvariant=e.subvariant,a._serial=e.serial),a;},e.prototype.getDeviceCommands=function(e,t){var i=this.devicemanager.applyUIFilter(e,{catagory:"command",elems:"*"}),a=i?i.command:[];t&&t(null,a);},e.prototype.getDeviceStatus=function(e,t){var i=this.devicemanager.applyUIFilter(e,{catagory:"status",elems:"*"}),a=i?i.status:[];t&&t(null,a);},e.prototype.doCommand=function(e,t,i){var a=this.resolveDevice(e);a?a.executeCommandCreator(e,t,function(e){i&&i(e);}):i&&i(new Error("device json format invalid"));},e.prototype.doStatus=function(e,t,i,a){var n=this.resolveDevice(t);if(n){var o=[{id:e,device:t,status:i}];n.getStatesCreator(null,o,function(e,t){e?a&&a(e):a&&a(null,t[0]);});}else a&&a(new Error("device json format invalid"));},e.prototype.discoverWithTimeout=function(e,t){if(!this._discoverRunning){var i={},a=function a(e,t){!e&&t&&t.ip&&!i[t.ip]&&(i[t.ip]=t);},n=this;this.discoveryStart(a),this._discoverTO=setTimeout(function(){n.discoveryStop(a);var e=[];for(var o in i)i.hasOwnProperty(o)&&e.push(i[o]);t&&t(null,e);},e);}},e;}(),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.siegenia.Handler());